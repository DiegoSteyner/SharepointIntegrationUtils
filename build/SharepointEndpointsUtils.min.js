
function isNumberKey(e){var t=e.which?e.which:event.keyCode;return!(t>31&&(t<48||t>57))}function xmlToJson(e){var t={},n=1,r=3;if(e.nodeType==n){if(e.attributes.length>0){t.attributes={};for(var o=0;o<e.attributes.length;o++){var i=e.attributes.item(o);t.attributes[i.nodeName]=i.nodeValue}}}else e.nodeType==r&&(t=e.nodeValue);if(e.hasChildNodes())for(var a=0;a<e.childNodes.length;a++){var l=e.childNodes.item(a),s=l.nodeName;if("undefined"==typeof t[s])t[s]=xmlToJson(l);else{if("undefined"==typeof t[s].push){var d=t[s];t[s]=[],t[s].push(d)}t[s].push(xmlToJson(l))}}return t}function addZeroToLeft(e,t){return(new Array(t+1).join("0")+e).slice(-t)}function ascendingSorting(e,t){return e-t}function descendingSorting(e,t){return t-e}function replaceAll(e,t,n){return e.replace(new RegExp(t,"g"),n)}function writeIFrameContent(e,t){var n=document.getElementById(e).contentWindow.document;n.open(),n.write(t),n.close()}function filterTable(e,t,n,r){var o,i,a,l;for(o=document.getElementById(e),i=o.getElementsByTagName("tr"),l=0;l<i.length;l++)a=i[l].getElementsByTagName("td")[n],a&&(r?a.innerHTML.toLowerCase().indexOf(t.toLowerCase())>-1?i[l].style.display="":i[l].style.display="none":a.innerHTML.indexOf(t)>-1?i[l].style.display="":i[l].style.display="none")}function clearString(e){if("undefined"==typeof e)return e;for(var t=[142,158,159,199,208,209,215,216,221,231,241,248,253],n=[90,122,89,67,68,78,88,79,89,99,110,111,121],r=192;r<199;r++)e=e.replace(new RegExp(String.fromCharCode(r),"g"),String.fromCharCode(41));for(var r=200;r<204;r++)e=e.replace(new RegExp(String.fromCharCode(r),"g"),String.fromCharCode(69));for(var r=204;r<208;r++)e=e.replace(new RegExp(String.fromCharCode(r),"g"),String.fromCharCode(73));for(var r=210;r<215;r++)e=e.replace(new RegExp(String.fromCharCode(r),"g"),String.fromCharCode(79));for(var r=217;r<221;r++)e=e.replace(new RegExp(String.fromCharCode(r),"g"),String.fromCharCode(85));for(var r=224;r<231;r++)e=e.replace(new RegExp(String.fromCharCode(r),"g"),String.fromCharCode(97));for(var r=232;r<236;r++)e=e.replace(new RegExp(String.fromCharCode(r),"g"),String.fromCharCode(101));for(var r=236;r<240;r++)e=e.replace(new RegExp(String.fromCharCode(r),"g"),String.fromCharCode(105));for(var r=242;r<247;r++)e=e.replace(new RegExp(String.fromCharCode(r),"g"),String.fromCharCode(111));for(var r=249;r<253;r++)e=e.replace(new RegExp(String.fromCharCode(r),"g"),String.fromCharCode(117));for(var r=0,o=n.length;r<o;r++)e=e.replace(new RegExp(String.fromCharCode(t[r]),"g"),String.fromCharCode(n[r]));return e}function execAsyncWithTimeout(e,t,n){setTimeout(function(){e(),t&&t()},n)}function createListItem(e,t){var n=Endpoints.listEndpoints,r=null;t.__metadata={type:GetListItemEntityType(e)};var o=createSimpleHeaderData(ObtemTokenDeSeguranca(),!1),i=formatUrlEndPoint(n.listByTitle.url+n.listByTitle.parameters.allItens,[e]);return createAjaxCall(i,"POST",o,t).done(function(e){r=e.d}).fail(function(e){console.log(JSON.stringify(e))}),r}function updateListItem(e,t,n){var r=Endpoints.listEndpoints,o=null;n.__metadata={type:GetListItemEntityType(e)};var i=createMergeHeaderData(ObtemTokenDeSeguranca()),a=formatUrlEndPoint(r.listByTitle.url+r.listByTitle.parameters.itemById,[e,t]);return createAjaxCall(a,"POST",i,n).done(function(e){o=[{status:"sucess"}]}).fail(function(e){console.log(JSON.stringify(e))}),o}function deleteListItem(e,t){var n=null,r=Endpoints.listEndpoints,o=createDeleteHeaderData(ObtemTokenDeSeguranca()),i=formatUrlEndPoint(r.listByTitle.url+r.listByTitle.parameters.itemById,[e,t]);return createAjaxCall(i,"POST",o,null).done(function(e){n=e}).fail(function(e){console.log(JSON.stringify(e))}),n}function downloadFileByBlobRequest(e,t,n){var r=new XMLHttpRequest,o=Endpoints.fileEndPoints,i=formatUrlEndPoint(o.fileByRelativePath.url+o.fileByRelativePath.parameters.downloadFileBinary,[e]);r.open("GET",i),r.responseType="arraybuffer",r.onload=function(){if(200===this.status){var e=new Blob([r.response],{type:"application/octet-stream"}),o=URL.createObjectURL(e);if(t)o.app,window.open(o);else{var i=document.createElement("a");i.href=o,i.download=n,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(o),i.remove()}}},r.send()}function downloadFileBySharepointDelegate(e){location.href=formatUrlEndPoint(Endpoints.generalEndpoints.downloadFileByDelegation.url,[e])}function getListItens(e){var t=null,n=Endpoints.listEndpoints,r=createDefaultHeaderData(ObtemTokenDeSeguranca()),o=formatUrlEndPoint(n.listByTitle.url+n.listByTitle.parameters.allItens,[e]);return createAjaxCall(o,"GET",r,null).done(function(e){t=e.d}).fail(function(e){console.log(JSON.stringify(e))}),t}function getListItemByID(e,t){var n=null,r=Endpoints.listEndpoints,o=createDefaultHeaderData(ObtemTokenDeSeguranca()),i=formatUrlEndPoint(r.listByTitle.url+r.listByTitle.parameters.itemById,[e,t]);return createAjaxCall(i,"GET",o,null).done(function(e){n=e.d}).fail(function(e){console.log(JSON.stringify(e))}),n}function getAllColumnsList(e,t){var n=[],r=Endpoints.listEndpoints,o=formatUrlEndPoint(r.listByTitle.url+r.listByTitle.parameters.allFields,[e]);return getAjaxCallToReadUrl(o,!1,!1).success(function(e){for(var r=xmlToJson(e),o=0;o<r.feed.entry.length;o++)t?"false"==r.feed.entry[o].content["m:properties"]["d:FromBaseType"]["#text"]&&n.push({EntityPropertyName:r.feed.entry[o].content["m:properties"]["d:EntityPropertyName"]["#text"],Description:r.feed.entry[o].content["m:properties"]["d:Description"]["#text"],FieldTypeKind:r.feed.entry[o].content["m:properties"]["d:FieldTypeKind"]["#text"],InternalName:r.feed.entry[o].content["m:properties"]["d:InternalName"]["#text"],StaticName:r.feed.entry[o].content["m:properties"]["d:StaticName"]["#text"],Title:r.feed.entry[o].content["m:properties"]["d:Title"]["#text"]}):n.push({EntityPropertyName:r.feed.entry[o].content["m:properties"]["d:EntityPropertyName"]["#text"],Description:r.feed.entry[o].content["m:properties"]["d:Description"]["#text"],FieldTypeKind:r.feed.entry[o].content["m:properties"]["d:FieldTypeKind"]["#text"],InternalName:r.feed.entry[o].content["m:properties"]["d:InternalName"]["#text"],StaticName:r.feed.entry[o].content["m:properties"]["d:StaticName"]["#text"],Title:r.feed.entry[o].content["m:properties"]["d:Title"]["#text"]})}).error(function(e){console.log(JSON.stringify(e))}),n}function getActualUrlFolder(){var e=decodeURIComponent(window.parent.location);if(e.indexOf("RootFolder")!=-1){var t=-1,n=e.indexOf("RootFolder=");return t=e.indexOf("&")!=-1?e.indexOf("&"):e.length,e.substring(n==-1?0:n+"RootFolder=".length,t)}return"/"}function getGroupByName(e){var t=null,n=Endpoints.securityEndpoints,r=createSimpleHeaderData(ObtemTokenDeSeguranca()),o=formatUrlEndPoint(n.siteGroups.url+"?"+n.siteGroups.parameters.groupByName,[e]);return getAjaxCallWithData("GET",o,!1,!1,r,null).success(function(e){t=e.d.results}).error(function(e){console.log(JSON.stringify(e))}),t}function getAllGroups(){var e=null,t=Endpoints.securityEndpoints,n=createSimpleHeaderData(ObtemTokenDeSeguranca()),r=formatUrlEndPoint(t.siteGroups.url);return getAjaxCallWithData("GET",r,!1,!1,n,null).success(function(t){e=t.d.results}).error(function(e){console.log(JSON.stringify(e))}),e}function getFolderContent(e,t){var n=null,r=Endpoints.foldeEndpoints,o=t?r.folderByRelativeUrl.parameters.files:r.folderByRelativeUrl.parameters.folders,i=formatUrlEndPoint(r.folderByRelativeUrl.url+o,[e]);return createAjaxCall(i,"GET",createDefaultHeaderData(),null).done(function(e){n=e.d}).fail(function(e){console.log(JSON.stringify(e))}),n}function getAllContentInList(e,t){return getAllContentInListQuery(e,t,'<View Scope="RecursiveAll"></View>')}function getAllContentInListQuery(e,t,n){var r=null,o={query:{__metadata:{type:"SP.CamlQuery"},ViewXml:n}},i=Endpoints.listEndpoints,a=formatUrlEndPoint(i.listByTitle.url+i.listByTitle.parameters.allItens,[e]);return createAjaxCall(a+(t?t:""),"GET",createDefaultHeaderData(),o).done(function(e){r=e.d}).fail(function(e){console.log(JSON.stringify(e))}),r}function getJsonFromUrl(e,t){var n=null;return getJsonData(e,t,createDefaultHeaderData(),null).done(function(e){n=e.d}).fail(function(e){console.log(JSON.stringify(e))}),n}function execSearch(e,t){var n=Endpoints.generalEndpoints,r=formatUrlEndPoint(n.fullText.url,[e]);return getJsonFromUrl(r+(t?t:""))}function CheckoutFile(e){var t=null,n=Endpoints.fileEndPoints,r=formatUrlEndPoint(n.fileByRelativePath.url+n.fileByRelativePath.parameters.checkout,[e]);return createAjaxCall(r,"POST",createSimpleHeaderData(ObtemTokenDeSeguranca(),!1),null).done(function(e){t=e}).fail(function(e){console.log(JSON.stringify(e))}),t}function CheckinFile(e,t){var n=Endpoints.fileEndPoints,r=formatUrlEndPoint(n.fileByRelativePath.url+n.fileByRelativePath.parameters.checkin,[e,t]),o=null;$.ajax({url:r,method:"POST",async:!1,cache:!1,headers:createSimpleHeaderData(ObtemTokenDeSeguranca(),!1),success:function(e){o=e},error:function(e){console.log(JSON.stringify(e)),console.log(e.responseText)}})}function UndoCheckoutFile(e){var t=null,n=Endpoints.fileEndPoints,r=formatUrlEndPoint(n.fileByRelativePath.url+n.fileByRelativePath.parameters.undoCheckout,[e]);return createAjaxCall(r,"POST",createSimpleHeaderData(ObtemTokenDeSeguranca(),!1),null).done(function(e){t=e}).fail(function(e){console.log(JSON.stringify(e))}),t}function createListColumn(e,t,n,r,o,i,a){var l,s=getAllListInSiteContent().d.results,d={StaticName:n,Title:r,FieldTypeKind:o,Required:i,EnforceUniqueValues:a};d.__metadata={type:"SP.Field"};for(var u=0;u<s.length;u++)if(s[u].Title==e){getAjaxCallWithData("POST",s[u].Fields.__deferred.uri,!1,!1,createSimpleHeaderData(ObtemTokenDeSeguranca(),!0),JSON.stringify(d)).success(function(e){d=null,d={Title:t},d.__metadata={type:"SP.Field"},getAjaxCallWithData("POST",e.d.__metadata.uri,!1,!1,createMergeHeaderData(ObtemTokenDeSeguranca()),JSON.stringify(d)).success(function(e){l=e}).error(function(e){console.log(JSON.stringify(e))})}).error(function(e){console.log(JSON.stringify(e))});break}return l}function getAllListInSiteContent(){var e=null;return createAjaxCall(formatUrlEndPoint(Endpoints.listEndpoints.allList.url,[]),"GET",createDefaultHeaderData(),null).done(function(t){e=t}).fail(function(e){console.log(JSON.stringify(e))}),e}function getSingleListProperties(e){var t=null;return createAjaxCall(formatUrlEndPoint(Endpoints.listEndpoints.listByTitle.url,[e]),"GET",createDefaultHeaderData(),null).done(function(e){t=e.d}).fail(function(e){console.log(JSON.stringify(e))}),t}function getCurrentUser(){var e=[];return $.ajax({url:formatUrlEndPoint(Endpoints.securityEndpoints.siteUsers.currentUser.url,[]),async:!1,cache:!1,success:function(t){e=xmlToJson(t)}}),e}function uploadDocument(e,t,n,r,o,i,a){function l(e,n){var i=!1,a=s(e,t,n,r,o);return a.done(function(e,t,n){var r=d(e.d);r.done(function(e,t,n){i=!0}),r.fail(function(e,t,n){i=!1,u(e,t,n)}),i=!0}),a.fail(function(e,t,n){return u(e,t,n),i=!1,!1}),i}function s(e,t,n,r,o){var i=n;null!=r&&r.length>0&&(i=r+n);var a=jQuery.ajax({url:formatUrlEndPoint(p.listByTitle.url+p.listByTitle.parameters.addFileInList,[t,i,o]),type:"POST",async:!1,data:e,processData:!1,headers:createDefaultHeaderData(ObtemTokenDeSeguranca())});return a}function d(e){var t=jQuery.ajax({url:e.ListItemAllFields.__deferred.uri,type:"GET",async:!1,dataType:"json",headers:{Accept:"application/json;odata=verbose"}});return t}function u(e,t,n){var r=JSON.parse(e.responseText),o=r?r.error.message.value:t;console.log(o)}var c=!1;if(!window.FileReader)return console.log("Esse navegador não suporta HTML5"),c;var f=new FileReader,p=Endpoints.listEndpoints;f.onload=function(e){l(e.target.result,n)},f.onerror=a,f.onloadend=i,f.readAsArrayBuffer(e)}function getFolderProperties(e){var t=null;return createAjaxCall(formatUrlEndPoint(Endpoints.foldeEndpoints.folderByRelativeUrl.url,[e]),"GET",createDefaultHeaderData(),null).done(function(e){t=e.d}).fail(function(e){console.log(JSON.stringify(e))}),t}function GetListItemEntityType(e){var t=null,n=Endpoints.listEndpoints,r=formatUrlEndPoint(n.listByTitle.url+"?"+n.listByTitle.parameters.listEntityType,[e]),o=$.ajax({type:"GET",url:r,cache:!1,async:!1});return o.done(function(e){var n=xmlToJson(e);t=getElementValue(n,"d:ListItemEntityTypeFullName")["#text"]}),t}function sendEmailTo(e,t,n,r){var o=null,i={properties:{__metadata:{type:"SP.Utilities.EmailProperties"},From:e,To:{results:[t]},Body:n,Subject:r}},a=createSimpleHeaderData(ObtemTokenDeSeguranca(),!0),l=formatUrlEndPoint(Endpoints.generalEndpoints.sendMail.url,[]);return getAjaxCallWithData("POST",l,!1,!0,a,JSON.stringify(i)).success(function(e){o=e.d}).error(function(e){console.log(JSON.stringify(e))}),o}function GetInternalListFieldsNames(e,t){var n=[];n.length=t.length;var r=Endpoints.listEndpoints,o=formatUrlEndPoint(r.listByTitle.url+r.listByTitle.parameters.allFields,[e]),i=$.ajax({type:"GET",url:o,cache:!1,async:!1});return i.done(function(e){var r=xmlToJson(e),o="";r=r.feed.entry;for(var i=0;i<r.length;i++){o=r[i].content["m:properties"]["d:Title"]["#text"];for(var a=0;a<t.length;a++)if(o==t[a]){n[a]=r[i].content["m:properties"]["d:EntityPropertyName"]["#text"];break}}}),n}function ObtemTokenDeSeguranca(e){var t;return $.ajax({url:getSiteUrl(e)+"/_api/contextinfo",type:"POST",cache:!1,async:!1,headers:{Accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"},success:function(e){t=e.d.GetContextWebInformation.FormDigestValue}}),t}function setPalavrasChaves(e,t,n,r,o,i){var a=SP.ClientContext.get_current(),l=a.get_web().get_lists().getByTitle(e),s=l.getItemById(r),d=l.get_fields().getByInternalNameOrTitle(t),u=a.castTo(d,SP.Taxonomy.TaxonomyField),c=new SP.Taxonomy.TaxonomyFieldValueCollection(a,o,u);s.set_item(n,o),s.update(),a.load(c),a.executeQueryAsync(i,function(e,t){console.log(t.get_message()+"\n"+t.get_stackTrace())})}function getNewContextForSite(e){return new SP.ClientContext(e)}function getURLSync(e){return $.ajax({type:"GET",url:e,cache:!1,async:!1}).responseText}function formatUrlEndPoint(e,t,n){var r=getSiteUrl(n),o=e.split(/\{\d\}/g),i="";t||(t=[]);for(var a=0;a<o.length;a++)i=""==o[a].toString().trim()?i+"{"+a+"}":i+o[a]+"{"+a+"}";t.unshift(r);for(var a=0;a<t.length;a++)i=i.replace("{"+a+"}",t[a]);return o=null,String.format(i,"")}function getElementValue(e,t){for(var n=Object.keys(e),r="",o=0;o<n.length;o++){if(n[o]==t)return e[n[o]];"object"==typeof e[n[o]]&&(r=getElementValue(JSON.parse(JSON.stringify(e[n[o]])),t))}return r}function getSiteUrl(e){return e?e:window.parent._spPageContextInfo.webAbsoluteUrl}function createDefaultHeaderData(e){return createHeaderData([{"X-RequestDigest":e,accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose","Access-Control-Allow-Origin":"*","IF-MATCH":"*"}])}function createMergeHeaderData(e){return createHeaderData([{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":e,"IF-MATCH":"*","X-HTTP-Method":"MERGE"}])}function createSimpleHeaderData(e,t){var n=createHeaderData([{Accept:"application/json;odata=verbose","X-RequestDigest":e}]);return t&&(n["content-type"]="application/json;odata=verbose"),n}function createDeleteHeaderData(e){return createHeaderData([{"X-RequestDigest":e,"IF-MATCH":"*","X-HTTP-Method":"DELETE"}])}function createHeaderData(e){for(var t=t||{},n=0;n<Object.keys(e[0]).length;n++)t[Object.keys(e[0])[n]]=e[0][Object.keys(e[0])[n]];return t}function getAjaxCallWithData(e,t,n,r,o,i){return null!=i?$.ajax({type:e,url:t,cache:n,async:r,headers:o,data:i}):$.ajax({type:e,url:t,cache:n,async:r,headers:o})}function getAjaxCallToReadUrl(e,t,n){return $.ajax({url:e,async:n,cache:t})}function createAjaxCall(e,t,n,r){var o={url:e,type:t,cache:!1,async:!1,contentType:"application/json;odata=verbose",headers:n};"undefined"!=typeof r&&(o.data=JSON.stringify(r));var i=jQuery.ajax(o);return i}function formatTaxonomyField(e,t,n){String.format("{0};#{1}|{2}",e,t,n)}function myFunction(){var e=document.createElement("INPUT"),t=document.createElement("BUTTON");e.setAttribute("type","file"),e.setAttribute("id","uploadInput"),t.setAttribute("onclick","uploadDocument()"),t.setAttribute("id","mytestebutton"),document.body.appendChild(e),document.body.appendChild(t),e.click(),console.log(e.files[0])}function clickMyButton(){document.getElementById("mytestebutton").click()}function uploadMyFile(){var e=document.getElementById("uploadInput"),t=e.files[0],n=e.value.split("\\"),r=n[n.length-1];uploadDocument(t,"Documentos",r,"Documents/Teste/",!1,function(e){console.log("Documento enviado com sucesso")},function(e){console.log("Não foi possível enviar o documento")})}function downloadFile(){downloadFileByBlobRequest("/portal/procuradoria/Documents/CSOM%20vs%20Rest%20API.pdf",!0,"api.pdf")}window.FieldTypeInteger=1,window.FieldTypeText=2,window.FieldTypeNote=3,window.FieldTypeDateTime=4,window.FieldTypeCounter=5,window.FieldTypeChoice=6,window.FieldTypeLookup=7,window.FieldTypeBoolean=8,window.FieldTypeNumber=9,window.FieldTypeCurrency=10,window.FieldTypeURL=11,window.FieldTypeComputed=12,window.FieldTypeThreading=13,window.FieldTypeGuid=14,window.FieldTypeMultiChoice=15,window.FieldTypeGridChoice=16,window.FieldTypeCalculated=17,window.FieldTypeFile=18,window.FieldTypeAttachments=19,window.FieldTypeUser=20,window.FieldTypeRecurrence=21,window.FieldTypeCrossProjectLink=22,window.FieldTypeModStat=23,window.FieldTypeError=24,window.FieldTypeContentTypeId=25,window.FieldTypePageSeparator=26,window.FieldTypeThreadIndex=27,window.FieldTypeWorkflowStatus=28,window.FieldTypeAllDayEvent=29,window.FieldTypeWorkflowEventType=30,window.FieldTypeMaxItems=31;var waitForElement=function(e,t,n,r){jQuery(e).length?t():setTimeout(function(){n||(n=0),n++,n<r&&waitForElement(e,t,n,r)},100)},waitForElementByAnimation=function(e,t,n,r){jQuery(e).size()?t():setTimeout(function(){n||(n=0),n++,n<r&&window.requestAnimationFrame(function(){waitForElementByAnimation(e,t,n,r)})},100)};window.Endpoints=Object.freeze({listEndpoints:{allList:{url:"{0}/_api/Web/Lists"},listByTitle:{url:"{0}/_api/Web/Lists/GetByTitle('{1}')",parameters:{listEntityType:"$select=ListItemEntityTypeFullName",addFileOnFolder:"/RootFolder/Files/Add(url='{2}', overwrite={3})",allItens:"/Items",itemById:"/Items({2})",allFields:"/Fields",returnTop:"$skip={0}&$top={1}",addFileInList:"/RootFolder/Files/Add(url='{2}', overwrite={3})"}}},foldeEndpoints:{folderByRelativeUrl:{url:"{0}/_api/web/GetFolderByServerRelativeUrl('{1}')",parameters:{files:"/Files",folders:"/Folders"}}},fileEndPoints:{fileByRelativePath:{url:"{0}/_api/web/GetFileByServerRelativeUrl('{1}')",parameters:{downloadFileBinary:"/$value",checkout:"/CheckOut()",checkin:"/CheckIn(comment='{2}',checkintype=0)",undoCheckout:"/UndoCheckout()"}}},securityEndpoints:{siteGroups:{url:"{0}/_api/web/sitegroups",parameters:{groupByName:"$filter=startswith(Title,'{0}') eq true"}},siteUsers:{allUsers:{url:"{0}/_api/web/siteusers"},currentUser:{url:"{0}/_api/Web/CurrentUser"}}},generalEndpoints:{sendMail:{url:"{0}/_api/SP.Utilities.Utility.SendEmail"},fullText:{url:"{0}/_api/search/query?querytext='{1}'",parameters:{startRow:"startrow={0}",refineFilter:"refinementfilters='{1}",refineFilterByFileType:"refinementfilters='FileType:equals({2})",sortList:"sortlist={3}",sortListByPopularity:"sortlist='viewslifetime:ascending'",rowLimit:"rowlimit={4}",trimduplicate:"trimduplicates={5}"}},downloadFileByDelegation:{url:"{0}/_layouts/download.aspx?SourceUrl={1}",parameters:{}}}});
